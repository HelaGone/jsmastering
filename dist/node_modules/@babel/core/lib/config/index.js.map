{"version":3,"file":"index.js","names":["loadOptionsImpl","_gensync","data","require","_full","_partial","_item","_rewriteStackTrace","loadPartialConfigRunner","loadPartialConfig","loadPartialConfigAsync","beginHiddenCallStack","async","apply","arguments","loadPartialConfigSync","sync","opts","callback","undefined","errback","_config$options","config","_regeneratorRuntime","wrap","loadOptionsImpl$","_context","prev","next","delegateYield","t0","abrupt","options","stop","_marked","loadOptionsRunner","loadOptionsAsync","loadOptionsSync","loadOptions","createConfigItemRunner","createConfigItem","createConfigItemAsync","createConfigItemSync","target"],"sources":["../../src/config/index.ts"],"sourcesContent":["import gensync, { type Handler } from \"gensync\";\n\nexport type {\n  ResolvedConfig,\n  InputOptions,\n  PluginPasses,\n  Plugin,\n} from \"./full.ts\";\n\nimport type { PluginTarget } from \"./validation/options.ts\";\n\nimport type {\n  PluginAPI as basePluginAPI,\n  PresetAPI as basePresetAPI,\n} from \"./helpers/config-api.ts\";\nexport type { PluginObject } from \"./validation/plugins.ts\";\ntype PluginAPI = basePluginAPI & typeof import(\"..\");\ntype PresetAPI = basePresetAPI & typeof import(\"..\");\nexport type { PluginAPI, PresetAPI };\n// todo: may need to refine PresetObject to be a subset of ValidatedOptions\nexport type {\n  CallerMetadata,\n  ValidatedOptions as PresetObject,\n} from \"./validation/options.ts\";\n\nimport loadFullConfig, { type ResolvedConfig } from \"./full.ts\";\nimport {\n  type PartialConfig,\n  loadPartialConfig as loadPartialConfigImpl,\n} from \"./partial.ts\";\n\nexport { loadFullConfig as default };\nexport type { PartialConfig } from \"./partial.ts\";\n\nimport { createConfigItem as createConfigItemImpl } from \"./item.ts\";\nimport type { ConfigItem } from \"./item.ts\";\nexport type { ConfigItem };\n\nimport { beginHiddenCallStack } from \"../errors/rewrite-stack-trace.ts\";\n\nconst loadPartialConfigRunner = gensync(loadPartialConfigImpl);\nexport function loadPartialConfigAsync(\n  ...args: Parameters<typeof loadPartialConfigRunner.async>\n) {\n  return beginHiddenCallStack(loadPartialConfigRunner.async)(...args);\n}\nexport function loadPartialConfigSync(\n  ...args: Parameters<typeof loadPartialConfigRunner.sync>\n) {\n  return beginHiddenCallStack(loadPartialConfigRunner.sync)(...args);\n}\nexport function loadPartialConfig(\n  opts: Parameters<typeof loadPartialConfigImpl>[0],\n  callback?: (err: Error, val: PartialConfig | null) => void,\n) {\n  if (callback !== undefined) {\n    beginHiddenCallStack(loadPartialConfigRunner.errback)(opts, callback);\n  } else if (typeof opts === \"function\") {\n    beginHiddenCallStack(loadPartialConfigRunner.errback)(\n      undefined,\n      opts as (err: Error, val: PartialConfig | null) => void,\n    );\n  } else {\n    if (process.env.BABEL_8_BREAKING) {\n      throw new Error(\n        \"Starting from Babel 8.0.0, the 'loadPartialConfig' function expects a callback. If you need to call it synchronously, please use 'loadPartialConfigSync'.\",\n      );\n    } else {\n      return loadPartialConfigSync(opts);\n    }\n  }\n}\n\nfunction* loadOptionsImpl(opts: unknown): Handler<ResolvedConfig | null> {\n  const config = yield* loadFullConfig(opts);\n  // NOTE: We want to return \"null\" explicitly, while ?. alone returns undefined\n  return config?.options ?? null;\n}\nconst loadOptionsRunner = gensync(loadOptionsImpl);\nexport function loadOptionsAsync(\n  ...args: Parameters<typeof loadOptionsRunner.async>\n) {\n  return beginHiddenCallStack(loadOptionsRunner.async)(...args);\n}\nexport function loadOptionsSync(\n  ...args: Parameters<typeof loadOptionsRunner.sync>\n) {\n  return beginHiddenCallStack(loadOptionsRunner.sync)(...args);\n}\nexport function loadOptions(\n  opts: Parameters<typeof loadOptionsImpl>[0],\n  callback?: (err: Error, val: ResolvedConfig | null) => void,\n) {\n  if (callback !== undefined) {\n    beginHiddenCallStack(loadOptionsRunner.errback)(opts, callback);\n  } else if (typeof opts === \"function\") {\n    beginHiddenCallStack(loadOptionsRunner.errback)(\n      undefined,\n      opts as (err: Error, val: ResolvedConfig | null) => void,\n    );\n  } else {\n    if (process.env.BABEL_8_BREAKING) {\n      throw new Error(\n        \"Starting from Babel 8.0.0, the 'loadOptions' function expects a callback. If you need to call it synchronously, please use 'loadOptionsSync'.\",\n      );\n    } else {\n      return loadOptionsSync(opts);\n    }\n  }\n}\n\nconst createConfigItemRunner = gensync(createConfigItemImpl);\nexport function createConfigItemAsync(\n  ...args: Parameters<typeof createConfigItemRunner.async>\n) {\n  return beginHiddenCallStack(createConfigItemRunner.async)(...args);\n}\nexport function createConfigItemSync(\n  ...args: Parameters<typeof createConfigItemRunner.sync>\n) {\n  return beginHiddenCallStack(createConfigItemRunner.sync)(...args);\n}\nexport function createConfigItem(\n  target: PluginTarget,\n  options: Parameters<typeof createConfigItemImpl>[1],\n  callback?: (err: Error, val: ConfigItem<PluginAPI> | null) => void,\n) {\n  if (callback !== undefined) {\n    beginHiddenCallStack(createConfigItemRunner.errback)(\n      target,\n      options,\n      callback,\n    );\n  } else if (typeof options === \"function\") {\n    beginHiddenCallStack(createConfigItemRunner.errback)(\n      target,\n      undefined,\n      callback,\n    );\n  } else {\n    if (process.env.BABEL_8_BREAKING) {\n      throw new Error(\n        \"Starting from Babel 8.0.0, the 'createConfigItem' function expects a callback. If you need to call it synchronously, please use 'createConfigItemSync'.\",\n      );\n    } else {\n      return createConfigItemSync(target, options);\n    }\n  }\n}\n"],"mappings":";;;;sDAyEUA,eAAe;;;;;;;;;;;;;;;;;;;AAzEzB,SAAAC,SAAA;EAAA,IAAAC,IAAA,GAAAC,OAAA;EAAAF,QAAA,YAAAA,SAAA;IAAA,OAAAC,IAAA;EAAA;EAAA,OAAAA,IAAA;AAAA;AAyBA,IAAAE,KAAA,GAAAD,OAAA;AACA,IAAAE,QAAA,GAAAF,OAAA;AAQA,IAAAG,KAAA,GAAAH,OAAA;AAIA,IAAAI,kBAAA,GAAAJ,OAAA;AAEA,IAAMK,uBAAuB,GAAGP,QAAA,CAAM,CAAC,CAACI,QAAA,CAAAI,iBAAqB,CAAC;AACvD,SAASC,sBAAsBA,CAAA,EAEpC;EACA,OAAO,IAAAH,kBAAA,CAAAI,oBAAoB,EAACH,uBAAuB,CAACI,KAAK,CAAC,CAAAC,KAAA,SAAAC,SAAQ,CAAC;AACrE;AACO,SAASC,qBAAqBA,CAAA,EAEnC;EACA,OAAO,IAAAR,kBAAA,CAAAI,oBAAoB,EAACH,uBAAuB,CAACQ,IAAI,CAAC,CAAAH,KAAA,SAAAC,SAAQ,CAAC;AACpE;AACO,SAASL,iBAAiBA,CAC/BQ,IAAiD,EACjDC,QAA0D,EAC1D;EACA,IAAIA,QAAQ,KAAKC,SAAS,EAAE;IAC1B,IAAAZ,kBAAA,CAAAI,oBAAoB,EAACH,uBAAuB,CAACY,OAAO,CAAC,CAACH,IAAI,EAAEC,QAAQ,CAAC;EACvE,CAAC,MAAM,IAAI,OAAOD,IAAI,KAAK,UAAU,EAAE;IACrC,IAAAV,kBAAA,CAAAI,oBAAoB,EAACH,uBAAuB,CAACY,OAAO,CAAC,CACnDD,SAAS,EACTF,IACF,CAAC;EACH,CAAC,MAAM;IAKE;MACL,OAAOF,qBAAqB,CAACE,IAAI,CAAC;IACpC;EACF;AACF;AAEA,SAAUjB,eAAeA,CAACiB,IAAa;EAAA,IAAAI,eAAA,EAAAC,MAAA;EAAA,OAAAC,mBAAA,GAAAC,IAAA,UAAAC,iBAAAC,QAAA;IAAA,kBAAAA,QAAA,CAAAC,IAAA,GAAAD,QAAA,CAAAE,IAAA;MAAA;QACtB,OAAAF,QAAA,CAAAG,aAAA,CAAO,IAAAzB,KAAA,WAAc,EAACa,IAAI,CAAC;MAAA;QAApCK,MAAM,GAAAI,QAAA,CAAAI,EAAA;QAAA,OAAAJ,QAAA,CAAAK,MAAA,WAEZ,CAAAV,eAAA,GAAOC,MAAM,oBAANA,MAAM,CAAEU,OAAO,YAAAX,eAAA,GAAI,IAAI;MAAA;MAAA;QAAA,OAAAK,QAAA,CAAAO,IAAA;IAAA;EAAA,GAAAC,OAAA;AAAA;AAEhC,IAAMC,iBAAiB,GAAGlC,QAAA,CAAM,CAAC,CAACD,eAAe,CAAC;AAC3C,SAASoC,gBAAgBA,CAAA,EAE9B;EACA,OAAO,IAAA7B,kBAAA,CAAAI,oBAAoB,EAACwB,iBAAiB,CAACvB,KAAK,CAAC,CAAAC,KAAA,SAAAC,SAAQ,CAAC;AAC/D;AACO,SAASuB,eAAeA,CAAA,EAE7B;EACA,OAAO,IAAA9B,kBAAA,CAAAI,oBAAoB,EAACwB,iBAAiB,CAACnB,IAAI,CAAC,CAAAH,KAAA,SAAAC,SAAQ,CAAC;AAC9D;AACO,SAASwB,WAAWA,CACzBrB,IAA2C,EAC3CC,QAA2D,EAC3D;EACA,IAAIA,QAAQ,KAAKC,SAAS,EAAE;IAC1B,IAAAZ,kBAAA,CAAAI,oBAAoB,EAACwB,iBAAiB,CAACf,OAAO,CAAC,CAACH,IAAI,EAAEC,QAAQ,CAAC;EACjE,CAAC,MAAM,IAAI,OAAOD,IAAI,KAAK,UAAU,EAAE;IACrC,IAAAV,kBAAA,CAAAI,oBAAoB,EAACwB,iBAAiB,CAACf,OAAO,CAAC,CAC7CD,SAAS,EACTF,IACF,CAAC;EACH,CAAC,MAAM;IAKE;MACL,OAAOoB,eAAe,CAACpB,IAAI,CAAC;IAC9B;EACF;AACF;AAEA,IAAMsB,sBAAsB,GAAGtC,QAAA,CAAM,CAAC,CAACK,KAAA,CAAAkC,gBAAoB,CAAC;AACrD,SAASC,qBAAqBA,CAAA,EAEnC;EACA,OAAO,IAAAlC,kBAAA,CAAAI,oBAAoB,EAAC4B,sBAAsB,CAAC3B,KAAK,CAAC,CAAAC,KAAA,SAAAC,SAAQ,CAAC;AACpE;AACO,SAAS4B,oBAAoBA,CAAA,EAElC;EACA,OAAO,IAAAnC,kBAAA,CAAAI,oBAAoB,EAAC4B,sBAAsB,CAACvB,IAAI,CAAC,CAAAH,KAAA,SAAAC,SAAQ,CAAC;AACnE;AACO,SAAS0B,gBAAgBA,CAC9BG,MAAoB,EACpBX,OAAmD,EACnDd,QAAkE,EAClE;EACA,IAAIA,QAAQ,KAAKC,SAAS,EAAE;IAC1B,IAAAZ,kBAAA,CAAAI,oBAAoB,EAAC4B,sBAAsB,CAACnB,OAAO,CAAC,CAClDuB,MAAM,EACNX,OAAO,EACPd,QACF,CAAC;EACH,CAAC,MAAM,IAAI,OAAOc,OAAO,KAAK,UAAU,EAAE;IACxC,IAAAzB,kBAAA,CAAAI,oBAAoB,EAAC4B,sBAAsB,CAACnB,OAAO,CAAC,CAClDuB,MAAM,EACNxB,SAAS,EACTD,QACF,CAAC;EACH,CAAC,MAAM;IAKE;MACL,OAAOwB,oBAAoB,CAACC,MAAM,EAAEX,OAAO,CAAC;IAC9C;EACF;AACF;AAAC","ignoreList":[]}