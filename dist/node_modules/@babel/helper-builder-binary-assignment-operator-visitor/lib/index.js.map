{"version":3,"file":"index.js","names":["_t","require","_explodeAssignableExpression","assignmentExpression","sequenceExpression","_default","opts","build","operator","visitor","AssignmentExpression","path","node","scope","nodes","exploded","left","push","ref","uid","right","replaceWith","BinaryExpression"],"sources":["../src/index.ts"],"sourcesContent":["import { assignmentExpression, sequenceExpression } from \"@babel/types\";\nimport type { Visitor } from \"@babel/traverse\";\nimport type * as t from \"@babel/types\";\n\nimport explode from \"./explode-assignable-expression.ts\";\n\nexport default function (opts: {\n  build: (\n    left: t.Expression | t.PrivateName | t.Super,\n    right: t.Expression,\n  ) => t.Expression;\n  operator: t.BinaryExpression[\"operator\"];\n}) {\n  const { build, operator } = opts;\n\n  const visitor: Visitor = {\n    AssignmentExpression(path) {\n      const { node, scope } = path;\n      if (node.operator !== operator + \"=\") return;\n\n      const nodes: t.AssignmentExpression[] = [];\n      // @ts-expect-error Fixme: node.left can be a TSAsExpression\n      const exploded = explode(node.left, nodes, scope);\n      nodes.push(\n        assignmentExpression(\n          \"=\",\n          exploded.ref,\n          build(exploded.uid, node.right),\n        ),\n      );\n      path.replaceWith(sequenceExpression(nodes));\n    },\n\n    BinaryExpression(path) {\n      const { node } = path;\n      if (node.operator === operator) {\n        path.replaceWith(build(node.left, node.right));\n      }\n    },\n  };\n  return visitor;\n}\n"],"mappings":";;;;;;AAAA,IAAAA,EAAA,GAAAC,OAAA;AAIA,IAAAC,4BAAA,GAAAD,OAAA;AAAyD,IAJhDE,oBAAoB,GAAoBH,EAAA,CAAxCG,oBAAoB;EAAEC,kBAAA,GAAkBJ,EAAA,CAAlBI,kBAAA;AAMhB,SAAAC,SAAUC,IAMxB,EAAE;EACD,IAAQC,KAAK,GAAeD,IAAI,CAAxBC,KAAK;IAAEC,QAAA,GAAaF,IAAI,CAAjBE,QAAA;EAEf,IAAMC,OAAgB,GAAG;IACvBC,oBAAoB,WAAAA,qBAACC,IAAI,EAAE;MACzB,IAAQC,IAAI,GAAYD,IAAI,CAApBC,IAAI;QAAEC,KAAA,GAAUF,IAAI,CAAdE,KAAA;MACd,IAAID,IAAI,CAACJ,QAAQ,KAAKA,QAAQ,GAAG,GAAG,EAAE;MAEtC,IAAMM,KAA+B,GAAG,EAAE;MAE1C,IAAMC,QAAQ,GAAG,IAAAb,4BAAA,WAAO,EAACU,IAAI,CAACI,IAAI,EAAEF,KAAK,EAAED,KAAK,CAAC;MACjDC,KAAK,CAACG,IAAI,CACRd,oBAAoB,CAClB,GAAG,EACHY,QAAQ,CAACG,GAAG,EACZX,KAAK,CAACQ,QAAQ,CAACI,GAAG,EAAEP,IAAI,CAACQ,KAAK,CAChC,CACF,CAAC;MACDT,IAAI,CAACU,WAAW,CAACjB,kBAAkB,CAACU,KAAK,CAAC,CAAC;IAC7C,CAAC;IAEDQ,gBAAgB,WAAAA,iBAACX,IAAI,EAAE;MACrB,IAAQC,IAAA,GAASD,IAAI,CAAbC,IAAA;MACR,IAAIA,IAAI,CAACJ,QAAQ,KAAKA,QAAQ,EAAE;QAC9BG,IAAI,CAACU,WAAW,CAACd,KAAK,CAACK,IAAI,CAACI,IAAI,EAAEJ,IAAI,CAACQ,KAAK,CAAC,CAAC;MAChD;IACF;EACF,CAAC;EACD,OAAOX,OAAO;AAChB","ignoreList":[]}